# GCD

异步执行任务的技术之一，一般将应用程序中记述的线程管理用的代码在系统级中实现，开发者只需要定义想执行的任务并追加到适当的 **Dispatch Queue** 中，**GCD** 就能 **生成必要的线程** 并计划执行任务，因为线程管理时作为系统的一部分来实现，因此可以统一管理，也可执行任务，这样就比以前的线程更有效率。

## 多线程

一台机器中的每个 **物理CPU** 都可以虚拟出多个**虚拟CPU**（一般可能是2个）。

一个CPU核 **执行的命令列** 为一条 **无分叉路径**，当这种无分叉路径不只一条时即为 **多线程**。

这里的 **路径**、**命令列**可以看作就是一条线程。

一个CPU核一次能够执行的CPU命令始终为1，通过 **上下文切换**，CPU就能在多条路径中执行CPU命令列。

**上下文切换：**

XUN内核在发生操作系统事件时（如每隔一定时间，换气系统调用等情况）会 **切换** 执行路径。执行中的路径**状态**，如CPU的寄存器等信息会保存到各自路径**专用的内存块**中，从要切换到的目标路径专用的内存快中，**复原**CPU寄存器等信息，继续执行切换路径的 **CPU命令列**。

可能发生的**问题**：

* **数据竞争**：多个线程更新相同资源，导致数据不一致。
* **死锁**：停止等待事件的线程会导致多个线程互相持续等待。
* 太多线程导致小号大量内存。

## 主线程

应用程序在启动时，通过最先执行的线程来描绘用户界面、处理触摸屏幕的事件等，这个线程就是 **主线程**。

如果在主线程中进行长时间的处理，就会妨碍主线程的执行（阻塞），从而导致不能更新用户界面、应用程序的画面长时间停滞等问题。
